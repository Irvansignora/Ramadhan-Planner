<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Ramadhan">
<meta name="theme-color" content="#0A1628">
<meta name="description" content="Ramadhan Planner 30 Hari â€” by IRVAN_SIGNORA">
<title>Ramadhan Planner</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="icon" href="icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cinzel+Decorative:wght@700&family=Lateef:wght@400;600&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --navy:       #0A1628;
  --navy-mid:   #0F1F3D;
  --navy-card:  #132040;
  --navy-ele:   #1A2D55;
  --gold:       #D4AF37;
  --gold-light: #F0D060;
  --gold-dim:   #8B7020;
  --gold-glow:  rgba(212,175,55,0.15);
  --teal:       #1ABFB0;
  --teal-dim:   rgba(26,191,176,0.15);
  --cream:      #F0E6CC;
  --cream-dim:  #9A8A6A;
  --white:      #FFFFFF;
  --green:      #2ECC71;
  --green-dim:  rgba(46,204,113,0.15);
  --red:        #E74C3C;
  --red-dim:    rgba(231,76,60,0.15);

  --radius-sm:  8px;
  --radius-md:  14px;
  --radius-lg:  20px;
  --radius-xl:  28px;

  --tab-h:      68px;
  --safe-bot:   env(safe-area-inset-bottom, 0px);
}

* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

html, body {
  height: 100%;
  overflow: hidden;
  background: var(--navy);
  font-family: 'Tajawal', sans-serif;
  color: var(--cream);
  overscroll-behavior: none;
}

/* â”€â”€ APP SHELL â”€â”€ */
#app {
  display: flex;
  flex-direction: column;
  height: 100dvh;
  max-width: 480px;
  margin: 0 auto;
  position: relative;
  overflow: hidden;
  background: var(--navy);
}

/* â”€â”€ PAGES â”€â”€ */
.pages {
  flex: 1;
  overflow: hidden;
  position: relative;
}

.page {
  position: absolute;
  inset: 0;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  padding-bottom: calc(var(--tab-h) + var(--safe-bot) + 16px);
  opacity: 0;
  pointer-events: none;
  transform: translateY(12px);
  transition: opacity .25s ease, transform .25s ease;
}

.page.active {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

/* â”€â”€ BOTTOM NAV â”€â”€ */
.bottom-nav {
  flex-shrink: 0;
  display: flex;
  background: var(--navy-card);
  border-top: 1px solid rgba(212,175,55,0.12);
  height: calc(var(--tab-h) + var(--safe-bot));
  padding-bottom: var(--safe-bot);
  position: relative;
  z-index: 100;
}

.tab-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px 4px;
  position: relative;
  transition: all .2s;
}

.tab-icon {
  font-size: 22px;
  line-height: 1;
  transition: transform .2s;
}

.tab-label {
  font-family: 'Cinzel', serif;
  font-size: 8px;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--cream-dim);
  transition: color .2s;
}

.tab-btn.active .tab-icon { transform: translateY(-2px); }
.tab-btn.active .tab-label { color: var(--gold); }

.tab-btn.active::after {
  content: '';
  position: absolute;
  top: 0; left: 20%; right: 20%;
  height: 2px;
  background: var(--gold);
  border-radius: 0 0 4px 4px;
}

/* â”€â”€ SHARED COMPONENTS â”€â”€ */
.page-header {
  padding: 52px 20px 20px;
  background: linear-gradient(180deg, var(--navy-mid), transparent);
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.page-label {
  font-family: 'Cinzel', serif;
  font-size: 9px;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--gold-dim);
  margin-bottom: 4px;
}

.page-title {
  font-family: 'Cinzel Decorative', serif;
  font-size: 18px;
  font-weight: 700;
  color: var(--gold);
  letter-spacing: 1px;
}

.section-pad { padding: 0 16px; }

.card {
  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,0.1);
  border-radius: var(--radius-lg);
  padding: 18px;
  margin-bottom: 12px;
  position: relative;
  overflow: hidden;
}

.card::before {
  content:'';
  position:absolute;
  top:0; left:0; right:0;
  height:1px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity:.4;
}

.card-title {
  font-family: 'Cinzel', serif;
  font-size: 10px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Progress bar */
.prog-bar {
  height: 6px;
  background: rgba(255,255,255,0.06);
  border-radius: 99px;
  overflow: hidden;
}
.prog-fill {
  height: 100%;
  border-radius: 99px;
  background: linear-gradient(90deg, var(--gold-dim), var(--gold));
  transition: width .6s cubic-bezier(.4,0,.2,1);
}
.prog-fill.teal { background: linear-gradient(90deg, #0D9488, var(--teal)); }
.prog-fill.green { background: linear-gradient(90deg, #16A34A, var(--green)); }

/* Gold divider */
.divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(212,175,55,0.2), transparent);
  margin: 14px 0;
}

/* Chip/badge */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 10px;
  border-radius: 99px;
  font-size: 11px;
  font-weight: 500;
}
.badge-gold { background: var(--gold-glow); border: 1px solid rgba(212,175,55,0.3); color: var(--gold); }
.badge-teal { background: var(--teal-dim); border: 1px solid rgba(26,191,176,0.3); color: var(--teal); }
.badge-green { background: var(--green-dim); border: 1px solid rgba(46,204,113,0.3); color: var(--green); }

/* Input */
.field { margin-bottom: 14px; }
.field label {
  display: block;
  font-size: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--cream-dim);
  margin-bottom: 6px;
}
.field input, .field textarea, .field select {
  width: 100%;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(212,175,55,0.15);
  border-radius: var(--radius-sm);
  color: var(--cream);
  font-family: 'Tajawal', sans-serif;
  font-size: 15px;
  padding: 10px 14px;
  outline: none;
  transition: border-color .2s;
  resize: none;
}
.field input:focus, .field textarea:focus {
  border-color: rgba(212,175,55,0.5);
  background: rgba(212,175,55,0.04);
}
.field input::placeholder, .field textarea::placeholder {
  color: rgba(154,138,106,0.4);
  font-style: italic;
}
.field select option { background: var(--navy-card); }

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-family: 'Cinzel', serif;
  font-size: 11px;
  letter-spacing: 2px;
  text-transform: uppercase;
  padding: 12px 20px;
  transition: all .2s;
  white-space: nowrap;
}
.btn-gold {
  background: linear-gradient(135deg, var(--gold-dim), var(--gold));
  color: var(--navy);
  font-weight: 700;
}
.btn-gold:hover { filter: brightness(1.1); transform: translateY(-1px); }
.btn-outline {
  background: transparent;
  border: 1px solid rgba(212,175,55,0.3);
  color: var(--gold);
}
.btn-full { width: 100%; }
.btn-sm { padding: 8px 14px; font-size: 9px; }
.btn-danger { background: var(--red-dim); border: 1px solid rgba(231,76,60,0.3); color: var(--red); }

/* Toast */
#toast {
  position: fixed;
  bottom: calc(var(--tab-h) + var(--safe-bot) + 16px);
  left: 50%;
  transform: translateX(-50%) translateY(80px);
  background: var(--navy-ele);
  border: 1px solid rgba(212,175,55,0.3);
  border-radius: var(--radius-md);
  padding: 12px 22px;
  font-size: 13px;
  color: var(--cream);
  z-index: 9999;
  white-space: nowrap;
  transition: transform .35s cubic-bezier(.34,1.56,.64,1);
  max-width: calc(100% - 32px);
}
#toast.show { transform: translateX(-50%) translateY(0); }

/* Stars BG */
body::before {
  content:'';
  position:fixed; inset:0;
  background-image:
    radial-gradient(1px 1px at 8% 12%,  rgba(212,175,55,.5) 0%, transparent 100%),
    radial-gradient(1px 1px at 22% 38%, rgba(255,255,255,.3) 0%, transparent 100%),
    radial-gradient(1.5px 1.5px at 45% 8%,  rgba(212,175,55,.4) 0%, transparent 100%),
    radial-gradient(1px 1px at 65% 22%, rgba(255,255,255,.35) 0%, transparent 100%),
    radial-gradient(1px 1px at 78% 6%,  rgba(212,175,55,.45) 0%, transparent 100%),
    radial-gradient(1.5px 1.5px at 88% 32%, rgba(255,255,255,.25) 0%, transparent 100%),
    radial-gradient(1px 1px at 14% 65%, rgba(255,255,255,.2) 0%, transparent 100%),
    radial-gradient(1px 1px at 55% 72%, rgba(212,175,55,.25) 0%, transparent 100%),
    radial-gradient(1.5px 1.5px at 35% 85%, rgba(255,255,255,.3) 0%, transparent 100%),
    radial-gradient(1px 1px at 72% 88%, rgba(212,175,55,.4) 0%, transparent 100%),
    radial-gradient(1px 1px at 92% 78%, rgba(255,255,255,.3) 0%, transparent 100%);
  pointer-events:none; z-index:0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 1 â€” BERANDA (Home)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#page-home .page-header {
  padding: 56px 20px 16px;
}

.home-hero {
  padding: 0 16px 12px;
}

.hero-greeting {
  font-size: 13px;
  color: var(--cream-dim);
  margin-bottom: 2px;
  letter-spacing: 1px;
}

.hero-title {
  font-family: 'Cinzel Decorative', serif;
  font-size: 22px;
  color: var(--gold);
  line-height: 1.2;
  margin-bottom: 16px;
}

.hero-arabic {
  font-family: 'Lateef', serif;
  font-size: 36px;
  color: var(--gold);
  text-align: center;
  display: block;
  margin-bottom: 6px;
  text-shadow: 0 0 20px rgba(212,175,55,.4);
}

/* Progress Ring */
.progress-ring-wrap {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 20px;
  background: var(--navy-card);
  border-radius: var(--radius-xl);
  border: 1px solid rgba(212,175,55,.12);
  margin-bottom: 12px;
  position: relative;
  overflow: hidden;
}

.progress-ring-wrap::before {
  content:'';
  position:absolute; inset:0;
  background: radial-gradient(circle at 20% 50%, rgba(212,175,55,.05), transparent 60%);
}

.ring-svg { flex-shrink:0; }

.ring-track {
  fill: none;
  stroke: rgba(255,255,255,.06);
  stroke-width: 8;
}

.ring-prog {
  fill: none;
  stroke: url(#ringGrad);
  stroke-width: 8;
  stroke-linecap: round;
  transform: rotate(-90deg);
  transform-origin: 50% 50%;
  transition: stroke-dashoffset .8s cubic-bezier(.4,0,.2,1);
}

.ring-text {
  fill: var(--gold);
  font-family: 'Cinzel Decorative', serif;
  font-size: 16px;
  font-weight: 700;
  text-anchor: middle;
  dominant-baseline: middle;
}

.ring-sub {
  fill: var(--cream-dim);
  font-family: 'Tajawal', sans-serif;
  font-size: 9px;
  text-anchor: middle;
  dominant-baseline: middle;
}

.ring-info { flex: 1; }

.ring-day {
  font-family: 'Cinzel', serif;
  font-size: 11px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--cream-dim);
  margin-bottom: 4px;
}

.ring-day-num {
  font-family: 'Cinzel Decorative', serif;
  font-size: 36px;
  color: var(--cream);
  line-height: 1;
  margin-bottom: 2px;
}

.ring-day-num span { font-size: 16px; color: var(--cream-dim); }

.ring-hijri {
  font-size: 12px;
  color: var(--cream-dim);
  font-style: italic;
}

/* Quick stats */
.quick-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 12px;
}

.stat-card {
  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,.1);
  border-radius: var(--radius-md);
  padding: 14px 10px;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.stat-icon { font-size: 22px; margin-bottom: 6px; display: block; }

.stat-val {
  font-family: 'Cinzel', serif;
  font-size: 18px;
  font-weight: 700;
  color: var(--cream);
  line-height: 1;
  margin-bottom: 3px;
}

.stat-lbl {
  font-size: 9px;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--cream-dim);
}

/* Home menu cards */
.menu-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.menu-card {
  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,.1);
  border-radius: var(--radius-lg);
  padding: 18px 16px;
  cursor: pointer;
  transition: all .2s;
  position: relative;
  overflow: hidden;
}

.menu-card:hover, .menu-card:active {
  border-color: rgba(212,175,55,.3);
  transform: translateY(-2px);
}

.menu-card::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 3px;
}

.mc-prayer::after { background: linear-gradient(90deg, transparent, #5D8ABA, transparent); }
.mc-quran::after  { background: linear-gradient(90deg, transparent, var(--green), transparent); }
.mc-sedekah::after { background: linear-gradient(90deg, transparent, var(--gold), transparent); }
.mc-doa::after    { background: linear-gradient(90deg, transparent, var(--teal), transparent); }

.menu-icon { font-size: 28px; margin-bottom: 8px; display: block; }
.menu-name {
  font-family: 'Cinzel', serif;
  font-size: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--cream);
  margin-bottom: 4px;
}
.menu-sub { font-size: 11px; color: var(--cream-dim); font-style: italic; }

/* Today sholat strip */
.sholat-strip {
  display: flex;
  gap: 8px;
}

.sh-pill {
  flex: 1;
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(212,175,55,.1);
  border-radius: var(--radius-sm);
  padding: 10px 4px;
  text-align: center;
  cursor: pointer;
  transition: all .2s;
}

.sh-pill.done {
  background: var(--green-dim);
  border-color: rgba(46,204,113,.35);
}

.sh-pill.done .sh-name { color: var(--green); }

.sh-name {
  font-family: 'Cinzel', serif;
  font-size: 8px;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--cream-dim);
  display: block;
  margin-bottom: 4px;
}

.sh-check {
  font-size: 14px;
  display: block;
}

/* Start date banner */
.start-banner {
  background: linear-gradient(135deg, rgba(212,175,55,.08), rgba(212,175,55,.03));
  border: 1px dashed rgba(212,175,55,.3);
  border-radius: var(--radius-md);
  padding: 16px;
  text-align: center;
  margin-bottom: 12px;
}

.start-banner p {
  font-size: 13px;
  color: var(--cream-dim);
  margin-bottom: 10px;
  font-style: italic;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 2 â€” CHECKLIST HARIAN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.day-nav-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 0 16px 16px;
}

.day-nav-btn {
  width: 36px; height: 36px;
  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,.2);
  border-radius: 50%;
  color: var(--gold);
  font-size: 14px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all .2s;
  flex-shrink: 0;
}
.day-nav-btn:hover { background: var(--gold-glow); }
.day-nav-btn:disabled { opacity: .3; cursor: default; }

.day-badge-wrap { text-align: center; flex: 1; }
.day-badge-num {
  font-family: 'Cinzel Decorative', serif;
  font-size: 28px;
  color: var(--cream);
  line-height: 1;
}
.day-badge-lbl {
  font-family: 'Cinzel', serif;
  font-size: 9px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--cream-dim);
}
.day-badge-date {
  font-size: 11px;
  color: var(--cream-dim);
  font-style: italic;
  margin-top: 2px;
}

/* Check items */
.check-group { margin-bottom: 14px; }

.check-group-title {
  font-family: 'Cinzel', serif;
  font-size: 9px;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--cream-dim);
  margin-bottom: 8px;
  padding-left: 2px;
}

.check-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: rgba(255,255,255,.02);
  border: 1px solid rgba(255,255,255,.04);
  border-radius: var(--radius-sm);
  margin-bottom: 6px;
  cursor: pointer;
  transition: all .2s;
  user-select: none;
}

.check-item:hover { background: rgba(212,175,55,.04); }

.check-item.checked {
  background: var(--green-dim);
  border-color: rgba(46,204,113,.2);
}

.check-box-ui {
  width: 22px; height: 22px;
  border: 1.5px solid rgba(212,175,55,.35);
  border-radius: 5px;
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  transition: all .2s;
  background: transparent;
}

.check-item.checked .check-box-ui {
  background: var(--green);
  border-color: var(--green);
}

.check-box-ui::after {
  content: 'âœ“';
  color: white;
  font-size: 13px;
  font-weight: bold;
  opacity: 0;
  transition: opacity .15s;
}

.check-item.checked .check-box-ui::after { opacity: 1; }

.check-txt {
  flex: 1;
  font-size: 14px;
  color: var(--cream);
  transition: all .2s;
}

.check-item.checked .check-txt {
  color: var(--cream-dim);
  text-decoration: line-through;
}

.check-pts {
  font-family: 'Cinzel', serif;
  font-size: 10px;
  color: var(--gold-dim);
}

/* Daily summary bar */
.daily-summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: var(--navy-card);
  border-top: 1px solid rgba(212,175,55,.1);
  position: sticky;
  bottom: 0;
  z-index: 5;
}

.ds-label { font-size: 12px; color: var(--cream-dim); }
.ds-score {
  font-family: 'Cinzel', serif;
  font-size: 14px;
  color: var(--gold);
}

/* Mood selector */
.mood-row {
  display: flex;
  gap: 8px;
}

.mood-btn {
  flex: 1;
  background: rgba(255,255,255,.03);
  border: 1.5px solid rgba(255,255,255,.06);
  border-radius: var(--radius-sm);
  padding: 10px 4px;
  font-size: 20px;
  cursor: pointer;
  transition: all .2s;
  text-align: center;
}

.mood-btn.selected {
  background: var(--gold-glow);
  border-color: var(--gold);
  transform: scale(1.08);
}

/* Notes */
.notes-area {
  width: 100%;
  min-height: 80px;
  background: rgba(255,255,255,.02);
  border: 1px solid rgba(212,175,55,.12);
  border-radius: var(--radius-sm);
  color: var(--cream);
  font-family: 'Tajawal', sans-serif;
  font-size: 14px;
  padding: 12px;
  outline: none;
  resize: none;
  transition: border-color .2s;
}
.notes-area:focus { border-color: rgba(212,175,55,.4); }
.notes-area::placeholder { color: rgba(154,138,106,.35); font-style: italic; }

/* Save btn */
.save-row {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 4px;
}
.save-status {
  flex: 1;
  font-size: 11px;
  color: var(--cream-dim);
  font-style: italic;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 3 â€” TARGET IBADAH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.target-item {
  background: rgba(255,255,255,.02);
  border: 1px solid rgba(212,175,55,.1);
  border-radius: var(--radius-md);
  padding: 16px;
  margin-bottom: 10px;
  position: relative;
}

.target-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.target-name {
  font-family: 'Cinzel', serif;
  font-size: 11px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--cream);
  display: flex;
  align-items: center;
  gap: 8px;
}

.target-pct {
  font-family: 'Cinzel', serif;
  font-size: 13px;
  color: var(--gold);
}

.target-meta {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--cream-dim);
  margin-top: 8px;
}

.target-update-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}

.num-input {
  width: 80px;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(212,175,55,.2);
  border-radius: var(--radius-sm);
  color: var(--cream);
  font-family: 'Cinzel', serif;
  font-size: 15px;
  padding: 8px 12px;
  outline: none;
  text-align: center;
}
.num-input:focus { border-color: var(--gold); }

/* Habit tracker */
.habit-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: rgba(255,255,255,.02);
  border: 1px solid rgba(255,255,255,.05);
  border-radius: var(--radius-sm);
  margin-bottom: 8px;
}

.habit-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
}

.habit-name { flex: 1; font-size: 14px; }

.habit-streak {
  font-family: 'Cinzel', serif;
  font-size: 11px;
  color: var(--gold);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 4 â€” STATISTIK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 12px;
}

.stat-big {
  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,.1);
  border-radius: var(--radius-lg);
  padding: 18px 16px;
  text-align: center;
}

.stat-big-num {
  font-family: 'Cinzel Decorative', serif;
  font-size: 32px;
  color: var(--gold);
  line-height: 1;
  margin-bottom: 4px;
}

.stat-big-lbl {
  font-family: 'Cinzel', serif;
  font-size: 9px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--cream-dim);
}

/* Heatmap */
.heatmap-grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 4px;
}

.hm-cell {
  aspect-ratio: 1;
  border-radius: 3px;
  background: rgba(255,255,255,.05);
  transition: all .2s;
  cursor: pointer;
  position: relative;
}

.hm-cell.level-1 { background: rgba(212,175,55,.2); }
.hm-cell.level-2 { background: rgba(212,175,55,.45); }
.hm-cell.level-3 { background: rgba(212,175,55,.7); }
.hm-cell.level-4 { background: var(--gold); }

/* Juz tracker */
.juz-grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 6px;
}

.juz-cell {
  aspect-ratio: 1;
  border-radius: var(--radius-sm);
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(212,175,55,.1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all .2s;
  font-size: 8px;
  gap: 2px;
}

.juz-cell .jn { 
  font-family: 'Cinzel', serif;
  font-size: 7px;
  letter-spacing: 0;
  color: var(--cream-dim);
}
.juz-cell .jc { font-size: 13px; color: rgba(255,255,255,.15); }

.juz-cell.done {
  background: rgba(46,204,113,.12);
  border-color: rgba(46,204,113,.35);
}
.juz-cell.done .jc { color: var(--green); }
.juz-cell.done .jn { color: var(--green); }

/* Chart bars */
.bar-chart {
  display: flex;
  align-items: flex-end;
  gap: 4px;
  height: 80px;
}

.bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
  gap: 4px;
}

.bar {
  flex: 1;
  width: 100%;
  border-radius: 4px 4px 0 0;
  background: var(--gold-glow);
  border: 1px solid rgba(212,175,55,.2);
  transition: height .6s ease;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  position: relative;
  min-height: 4px;
}

.bar-inner {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  border-radius: 4px 4px 0 0;
  background: linear-gradient(180deg, var(--gold), var(--gold-dim));
  transition: height .6s ease;
}

.bar-lbl {
  font-family: 'Cinzel', serif;
  font-size: 7px;
  color: var(--cream-dim);
  letter-spacing: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 5 â€” CATATAN TABS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cat-tabs {
  display: flex;
  gap: 6px;
  overflow-x: auto;
  padding-bottom: 10px;
  margin-bottom: 4px;
  scrollbar-width: none;
}
.cat-tabs::-webkit-scrollbar { display: none; }

.cat-tab {
  flex-shrink: 0;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(212,175,55,.12);
  border-radius: 99px;
  color: var(--cream-dim);
  font-family: 'Cinzel', serif;
  font-size: 9px;
  letter-spacing: 1px;
  padding: 7px 14px;
  cursor: pointer;
  white-space: nowrap;
  transition: all .2s;
}
.cat-tab.active {
  background: var(--gold-glow);
  border-color: rgba(212,175,55,.4);
  color: var(--gold);
}

.cat-panel { display: none; }
.cat-panel.active { display: block; }

/* Hub grid */
.hub-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 6px;
}

.hub-btn {
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.07);
  border-radius: var(--radius-sm);
  color: var(--cream-dim);
  font-family: 'Tajawal', sans-serif;
  font-size: 12px;
  padding: 7px 4px;
  cursor: pointer;
  transition: all .2s;
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.hub-btn:hover { border-color: rgba(212,175,55,.3); color: var(--cream); }
.hub-btn.selected {
  background: var(--gold-glow);
  border-color: rgba(212,175,55,.5);
  color: var(--gold);
}

/* Template chips */
.tpl-row {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.tpl-chip {
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.07);
  border-radius: 99px;
  color: var(--cream-dim);
  font-size: 11px;
  padding: 5px 12px;
  cursor: pointer;
  transition: all .2s;
  white-space: nowrap;
}
.tpl-chip:hover { border-color: rgba(212,175,55,.3); color: var(--cream); }
.tpl-chip.active {
  background: var(--gold-glow);
  border-color: rgba(212,175,55,.4);
  color: var(--gold);
}

/* WA input */
.wa-inp-wrap {
  display: flex;
  align-items: center;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(212,175,55,.15);
  border-radius: var(--radius-sm);
  overflow: hidden;
  transition: border-color .2s;
}
.wa-inp-wrap:focus-within { border-color: rgba(212,175,55,.45); }
.wa-prefix {
  padding: 10px 12px;
  background: rgba(37,211,102,.08);
  border-right: 1px solid rgba(255,255,255,.06);
  color: #25D366;
  font-family: 'Cinzel', serif;
  font-size: 13px;
  font-weight: 600;
  flex-shrink: 0;
}
.wa-inp-wrap input {
  border: none !important;
  background: transparent !important;
  border-radius: 0 !important;
  flex: 1;
  min-width: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RECORD ITEMS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.record-item {  background: var(--navy-card);
  border: 1px solid rgba(212,175,55,.08);
  border-radius: var(--radius-md);
  padding: 14px 16px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all .2s;
}

.record-item:hover { border-color: rgba(212,175,55,.2); }

.record-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 6px;
}

.record-day {
  font-family: 'Cinzel', serif;
  font-size: 11px;
  letter-spacing: 2px;
  color: var(--gold);
}

.record-mood { font-size: 16px; }

.record-meta {
  font-size: 11px;
  color: var(--cream-dim);
  font-style: italic;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.record-detail {
  display: none;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255,255,255,.05);
}

.record-detail.open { display: block; }

.rd-row {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
  flex-wrap: wrap;
}

.rd-chip {
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.06);
  border-radius: 99px;
  padding: 3px 10px;
  font-size: 11px;
  color: var(--cream-dim);
}

.rd-note {
  font-size: 13px;
  color: var(--cream-dim);
  font-style: italic;
  line-height: 1.6;
  margin-top: 6px;
}

/* Doa input section */
.doa-card {
  background: linear-gradient(135deg, rgba(26,191,176,.05), transparent);
  border: 1px solid rgba(26,191,176,.2);
}

.doa-card .card-title { color: var(--teal); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PWA INSTALL BANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pwa-bar {
  display: none;
  position: fixed;
  bottom: calc(var(--tab-h) + var(--safe-bot));
  left: 0; right: 0;
  background: var(--navy-ele);
  border-top: 1px solid rgba(212,175,55,.25);
  padding: 12px 16px;
  z-index: 200;
  align-items: center;
  gap: 12px;
  max-width: 480px;
  margin: 0 auto;
}
#pwa-bar.show { display: flex; }
.pwa-text { flex: 1; }
.pwa-t { font-family:'Cinzel',serif; font-size:11px; letter-spacing:2px; color:var(--gold); margin-bottom:2px; }
.pwa-s { font-size:11px; color:var(--cream-dim); }
.pwa-btn { background:linear-gradient(135deg,var(--gold-dim),var(--gold)); color:var(--navy); border:none; border-radius:var(--radius-sm); padding:9px 16px; font-family:'Cinzel',serif; font-size:10px; letter-spacing:2px; font-weight:700; cursor:pointer; white-space:nowrap; }
.pwa-x { background:transparent; border:none; color:var(--cream-dim); font-size:16px; cursor:pointer; padding:4px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,.7);
  z-index: 500;
  display: none;
  align-items: flex-end;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.modal-overlay.open { display: flex; }

.modal-sheet {
  background: var(--navy-mid);
  border-radius: var(--radius-xl) var(--radius-xl) 0 0;
  border: 1px solid rgba(212,175,55,.15);
  border-bottom: none;
  width: 100%;
  max-width: 480px;
  padding: 24px 20px calc(24px + var(--safe-bot));
  max-height: 80vh;
  overflow-y: auto;
}

.modal-handle {
  width: 36px; height: 4px;
  background: rgba(255,255,255,.15);
  border-radius: 99px;
  margin: 0 auto 20px;
}

.modal-title {
  font-family: 'Cinzel Decorative', serif;
  font-size: 16px;
  color: var(--gold);
  margin-bottom: 20px;
}

/* Scrollbar */
::-webkit-scrollbar { width: 3px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(212,175,55,.2); border-radius: 99px; }

/* Ramadhan start date input */
input[type="date"] {
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(212,175,55,.2);
  border-radius: var(--radius-sm);
  color: var(--cream);
  font-family: 'Tajawal', sans-serif;
  font-size: 15px;
  padding: 10px 14px;
  outline: none;
  color-scheme: dark;
  width: 100%;
}

</style>
</head>
<body>

<div id="app">

  <!-- â•â• PAGES â•â• -->
  <div class="pages">

    <!-- PAGE 1: BERANDA -->
    <div class="page active" id="page-home">
      <div class="page-header">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div class="page-label">Selamat Datang</div>
            <div class="page-title">ğŸŒ™ Beranda</div>
          </div>
          <span class="hero-arabic" style="margin:0;font-size:28px">Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…</span>
        </div>
      </div>

      <div class="section-pad">
        <!-- Start banner (shown if no start date) -->
        <div class="start-banner" id="start-banner" style="display:none">
          <p>Set tanggal mulai Ramadhan untuk memulai tracking ğŸŒ™</p>
          <input type="date" id="home-start-input" onchange="setRamadhanStart(this.value)">
        </div>

        <!-- Progress Ring -->
        <div class="progress-ring-wrap" id="hero-ring">
          <svg class="ring-svg" width="90" height="90" viewBox="0 0 90 90">
            <defs>
              <linearGradient id="ringGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#8B7020"/>
                <stop offset="100%" stop-color="#D4AF37"/>
              </linearGradient>
            </defs>
            <circle class="ring-track" cx="45" cy="45" r="36"/>
            <circle class="ring-prog" id="ring-prog" cx="45" cy="45" r="36"
              stroke-dasharray="226.2" stroke-dashoffset="226.2"/>
            <text class="ring-text" x="45" y="41" id="ring-pct">0%</text>
            <text class="ring-sub" x="45" y="56" id="ring-sub">Hari ke-0</text>
          </svg>
          <div class="ring-info">
            <div class="ring-day">Ramadhan 1446 H</div>
            <div class="ring-day-num" id="ring-day-num">â€”<span>/30</span></div>
            <div class="ring-hijri" id="ring-hijri">Set tanggal dulu</div>
            <div style="margin-top:8px" id="ring-date-set" style="display:none">
              <input type="date" id="ring-start-input" onchange="setRamadhanStart(this.value)"
                style="font-size:12px;padding:6px 10px;width:auto">
            </div>
          </div>
        </div>

        <!-- Quick Stats -->
        <div class="quick-stats">
          <div class="stat-card">
            <span class="stat-icon">ğŸ•Œ</span>
            <div class="stat-val" id="stat-sholat">0</div>
            <div class="stat-lbl">Sholat</div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ“–</span>
            <div class="stat-val" id="stat-juz">0</div>
            <div class="stat-lbl">Juz</div>
          </div>
          <div class="stat-card">
            <span class="stat-icon">ğŸ’°</span>
            <div class="stat-val" id="stat-sedekah">0</div>
            <div class="stat-lbl">Sedekah</div>
          </div>
        </div>

        <!-- Today Sholat Quick Check -->
        <div class="card" style="margin-bottom:12px">
          <div class="card-title">ğŸ•Œ Sholat Hari Ini</div>
          <div class="sholat-strip" id="home-sholat">
            <div class="sh-pill" onclick="toggleHomeSholat(this,'Subuh')">
              <span class="sh-name">Subuh</span>
              <span class="sh-check">â˜</span>
            </div>
            <div class="sh-pill" onclick="toggleHomeSholat(this,'Dzuhur')">
              <span class="sh-name">Dzuhur</span>
              <span class="sh-check">â˜</span>
            </div>
            <div class="sh-pill" onclick="toggleHomeSholat(this,'Ashar')">
              <span class="sh-name">Ashar</span>
              <span class="sh-check">â˜</span>
            </div>
            <div class="sh-pill" onclick="toggleHomeSholat(this,'Maghrib')">
              <span class="sh-name">Maghrib</span>
              <span class="sh-check">â˜</span>
            </div>
            <div class="sh-pill" onclick="toggleHomeSholat(this,'Isya')">
              <span class="sh-name">Isya</span>
              <span class="sh-check">â˜</span>
            </div>
          </div>
        </div>

        <!-- Menu Grid -->
        <div class="menu-grid" style="margin-bottom:16px">
          <div class="menu-card mc-prayer" onclick="goTab('checklist')">
            <span class="menu-icon">ğŸ“‹</span>
            <div class="menu-name">Checklist</div>
            <div class="menu-sub">Daily ibadah log</div>
          </div>
          <div class="menu-card mc-quran" onclick="goTab('target')">
            <span class="menu-icon">ğŸ¯</span>
            <div class="menu-name">Target</div>
            <div class="menu-sub">Ibadah & hafalan</div>
          </div>
          <div class="menu-card mc-sedekah" onclick="goTab('statistik')">
            <span class="menu-icon">ğŸ“Š</span>
            <div class="menu-name">Statistik</div>
            <div class="menu-sub">Progress & chart</div>
          </div>
          <div class="menu-card mc-doa" onclick="goTab('catatan')">
            <span class="menu-icon">ğŸ¤²</span>
            <div class="menu-name">Catatan</div>
            <div class="menu-sub">Doa & refleksi</div>
          </div>
        </div>

        <!-- Footer -->
        <div style="text-align:center;padding:8px 0 4px">
          <div style="font-family:'Cinzel',serif;font-size:10px;letter-spacing:3px;color:var(--gold);margin-bottom:8px">ğŸŒ™ IRVAN_SIGNORA</div>
          <div style="display:flex;justify-content:center;gap:16px;margin-bottom:8px">
            <a href="https://instagram.com/irvan_signora" target="_blank" style="font-size:10px;color:var(--cream-dim);text-decoration:none;letter-spacing:1px;font-family:'Cinzel',serif">IG</a>
            <a href="https://twitter.com/irvan_signora" target="_blank" style="font-size:10px;color:var(--cream-dim);text-decoration:none;letter-spacing:1px;font-family:'Cinzel',serif">X</a>
            <a href="https://threads.net/@irvan_signora" target="_blank" style="font-size:10px;color:var(--cream-dim);text-decoration:none;letter-spacing:1px;font-family:'Cinzel',serif">TH</a>
          </div>
          <a href="https://trakteer.id/irvansignora/tip" target="_blank" style="display:inline-flex;align-items:center;gap:6px;background:rgba(212,175,55,.08);border:1px solid rgba(212,175,55,.2);border-radius:99px;padding:6px 16px;font-size:11px;color:var(--gold);text-decoration:none;font-family:'Cinzel',serif;letter-spacing:1px">â˜• Trakteer Creator</a>
        </div>
      </div>
    </div>

    <!-- PAGE 2: CHECKLIST HARIAN -->
    <div class="page" id="page-checklist">
      <div class="page-header">
        <div class="page-label">Ibadah Harian</div>
        <div class="page-title">ğŸ“‹ Checklist</div>
      </div>

      <div class="day-nav-bar">
        <button class="day-nav-btn" id="prev-day" onclick="navigateDay(-1)">â—€</button>
        <div class="day-badge-wrap">
          <div class="day-badge-num" id="cl-day-num">â€”</div>
          <div class="day-badge-lbl">Hari Ramadhan</div>
          <div class="day-badge-date" id="cl-day-date">â€”</div>
        </div>
        <button class="day-nav-btn" id="next-day" onclick="navigateDay(1)">â–¶</button>
      </div>

      <div class="section-pad">
        <!-- Mood -->
        <div class="card">
          <div class="card-title">ğŸ˜Š Mood Hari Ini</div>
          <div class="mood-row" id="cl-mood">
            <button class="mood-btn" onclick="setMood('ğŸ˜´')">ğŸ˜´</button>
            <button class="mood-btn" onclick="setMood('ğŸ˜Š')">ğŸ˜Š</button>
            <button class="mood-btn" onclick="setMood('ğŸ”¥')">ğŸ”¥</button>
            <button class="mood-btn" onclick="setMood('ğŸ˜Œ')">ğŸ˜Œ</button>
            <button class="mood-btn" onclick="setMood('ğŸ’ª')">ğŸ’ª</button>
          </div>
        </div>

        <!-- Sholat -->
        <div class="card">
          <div class="card-title">ğŸ•Œ Sholat Wajib</div>
          <div class="sholat-strip" id="cl-sholat">
            <div class="sh-pill" onclick="toggleSholat(this,'Subuh')"><span class="sh-name">Subuh</span><span class="sh-check">â˜</span></div>
            <div class="sh-pill" onclick="toggleSholat(this,'Dzuhur')"><span class="sh-name">Dzuhur</span><span class="sh-check">â˜</span></div>
            <div class="sh-pill" onclick="toggleSholat(this,'Ashar')"><span class="sh-name">Ashar</span><span class="sh-check">â˜</span></div>
            <div class="sh-pill" onclick="toggleSholat(this,'Maghrib')"><span class="sh-name">Maghrib</span><span class="sh-check">â˜</span></div>
            <div class="sh-pill" onclick="toggleSholat(this,'Isya')"><span class="sh-name">Isya</span><span class="sh-check">â˜</span></div>
          </div>
        </div>

        <!-- Ibadah Checklist -->
        <div class="card">
          <div class="card-title">â­ Amalan Harian</div>

          <div class="check-group">
            <div class="check-group-title">Wajib</div>
            <div class="check-item" onclick="toggleCheck(this,'tarawih')" data-key="tarawih">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸŒ™ Tarawih</span>
              <span class="check-pts">+3</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'quran')" data-key="quran">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ“– Baca Qur'an (min. 1 juz / 20 hlm)</span>
              <span class="check-pts">+5</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'sahur')" data-key="sahur">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸŒ… Sahur</span>
              <span class="check-pts">+2</span>
            </div>
          </div>

          <div class="check-group">
            <div class="check-group-title">Sunnah</div>
            <div class="check-item" onclick="toggleCheck(this,'qiyam')" data-key="qiyam">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸŒƒ Qiyamul Lail</span>
              <span class="check-pts">+4</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'dzikir')" data-key="dzikir">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ“¿ Dzikir Pagi & Petang</span>
              <span class="check-pts">+2</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'sedekah')" data-key="sedekah">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ¤² Sedekah Hari Ini</span>
              <span class="check-pts">+3</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'istighfar')" data-key="istighfar">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ” Istighfar 100x</span>
              <span class="check-pts">+2</span>
            </div>
            <div class="check-item" onclick="toggleCheck(this,'lisan')" data-key="lisan">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ‘… Jaga Lisan & Emosi</span>
              <span class="check-pts">+2</span>
            </div>
          </div>

          <div class="check-group">
            <div class="check-group-title">Refleksi</div>
            <div class="check-item" onclick="toggleCheck(this,'refleksi')" data-key="refleksi">
              <div class="check-box-ui"></div>
              <span class="check-txt">ğŸ’­ Refleksi 10 Menit</span>
              <span class="check-pts">+1</span>
            </div>
          </div>
        </div>

        <!-- Sedekah amount -->
        <div class="card">
          <div class="card-title">ğŸ’° Sedekah Hari Ini</div>
          <div class="field" style="margin:0">
            <input type="text" id="cl-sedekah" placeholder="Nominal atau bentuk sedekah..." oninput="markUnsaved()">
          </div>
        </div>

        <!-- Notes -->
        <div class="card">
          <div class="card-title">ğŸ“ Catatan & Doa Hari Ini</div>
          <textarea class="notes-area" id="cl-notes" rows="3" placeholder="Tulis refleksi, syukur, atau doa spesial hari ini..." oninput="markUnsaved()"></textarea>
        </div>

        <!-- Save -->
        <div class="save-row">
          <span class="save-status" id="save-status">âœï¸ Belum disimpan</span>
          <button class="btn btn-gold" onclick="saveRecord()">ğŸ’¾ Simpan</button>
        </div>
      </div>

      <!-- Daily score bar -->
      <div class="daily-summary">
        <div>
          <div class="ds-label">Skor Hari Ini</div>
          <div class="prog-bar" style="width:120px;margin-top:4px"><div class="prog-fill" id="cl-score-bar" style="width:0%"></div></div>
        </div>
        <div class="ds-score" id="cl-score">0 / 24 pts</div>
      </div>
    </div>

    <!-- PAGE 3: TARGET IBADAH -->
    <div class="page" id="page-target">
      <div class="page-header">
        <div class="page-label">Ramadhan 1446H</div>
        <div class="page-title">ğŸ¯ Target Ibadah</div>
      </div>

      <div class="section-pad">
        <!-- Set targets -->
        <div class="card">
          <div class="card-title">ğŸ“Œ Set Target Ramadhan</div>
          <div class="field">
            <label>ğŸ“– Target Khatam (berapa kali)</label>
            <input type="number" id="t-khatam" min="1" max="10" placeholder="contoh: 2" oninput="markTargetUnsaved()">
          </div>
          <div class="field">
            <label>ğŸ’° Target Sedekah Total (Rp)</label>
            <input type="number" id="t-sedekah" min="0" placeholder="contoh: 500000" oninput="markTargetUnsaved()">
          </div>
          <div class="field">
            <label>ğŸ“¿ Target Hafalan Baru (jumlah surat)</label>
            <input type="number" id="t-hafalan" min="1" placeholder="contoh: 5" oninput="markTargetUnsaved()">
          </div>
          <div class="field">
            <label>ğŸŒ± Kebiasaan yang Ingin Dibangun</label>
            <input type="text" id="t-habit-build" placeholder="tulis di sini..." oninput="markTargetUnsaved()">
          </div>
          <div class="save-row">
            <span class="save-status" id="target-save-status">âœï¸ Belum disimpan</span>
            <div style="display:flex;gap:8px">
              <button class="btn btn-danger btn-sm" onclick="resetTargets()">ğŸ—‘ï¸ Reset</button>
              <button class="btn btn-gold" onclick="saveTargetsManual()">ğŸ’¾ Simpan Target</button>
            </div>
          </div>
        </div>

        <!-- Progress targets -->
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
            <div class="card-title" style="margin-bottom:0">ğŸ“ˆ Update Progress</div>
            <button class="btn btn-danger btn-sm" onclick="resetAllProgress()">ğŸ—‘ï¸ Reset Semua</button>
          </div>

          <div class="target-item" id="tp-khatam">
            <div class="target-header">
              <div class="target-name">ğŸ“– Khatam Qur'an</div>
              <div style="display:flex;align-items:center;gap:6px">
                <div class="target-pct" id="tp-khatam-pct">0%</div>
                <button class="btn btn-danger btn-sm" style="padding:4px 8px;font-size:9px" onclick="resetProgress('khatam')">ğŸ—‘ï¸</button>
              </div>
            </div>
            <div class="prog-bar"><div class="prog-fill green" id="tp-khatam-bar" style="width:0%"></div></div>
            <div class="target-update-row">
              <input type="number" class="num-input" id="tp-khatam-val" min="0" placeholder="0" oninput="markProgressUnsaved('khatam')">
              <span style="font-size:12px;color:var(--cream-dim)">kali khatam</span>
              <button class="btn btn-gold btn-sm" onclick="saveProgress('khatam')">ğŸ’¾</button>
            </div>
            <div class="target-meta">
              <span id="tp-khatam-meta">Target: â€”</span>
              <span id="tp-khatam-status">Belum diset</span>
            </div>
          </div>

          <div class="target-item" id="tp-sedekah">
            <div class="target-header">
              <div class="target-name">ğŸ’° Sedekah Total</div>
              <div style="display:flex;align-items:center;gap:6px">
                <div class="target-pct" id="tp-sedekah-pct">0%</div>
                <button class="btn btn-danger btn-sm" style="padding:4px 8px;font-size:9px" onclick="resetProgress('sedekah')">ğŸ—‘ï¸</button>
              </div>
            </div>
            <div class="prog-bar"><div class="prog-fill" id="tp-sedekah-bar" style="width:0%"></div></div>
            <div class="target-update-row">
              <input type="number" class="num-input" id="tp-sedekah-val" min="0" placeholder="0" oninput="markProgressUnsaved('sedekah')">
              <span style="font-size:12px;color:var(--cream-dim)">Rp terkumpul</span>
              <button class="btn btn-gold btn-sm" onclick="saveProgress('sedekah')">ğŸ’¾</button>
            </div>
            <div class="target-meta">
              <span id="tp-sedekah-meta">Target: â€”</span>
              <span id="tp-sedekah-status">Belum diset</span>
            </div>
          </div>

          <div class="target-item" id="tp-hafalan">
            <div class="target-header">
              <div class="target-name">ğŸ“¿ Hafalan Baru</div>
              <div style="display:flex;align-items:center;gap:6px">
                <div class="target-pct" id="tp-hafalan-pct">0%</div>
                <button class="btn btn-danger btn-sm" style="padding:4px 8px;font-size:9px" onclick="resetProgress('hafalan')">ğŸ—‘ï¸</button>
              </div>
            </div>
            <div class="prog-bar"><div class="prog-fill teal" id="tp-hafalan-bar" style="width:0%"></div></div>
            <div class="target-update-row">
              <input type="number" class="num-input" id="tp-hafalan-val" min="0" placeholder="0" oninput="markProgressUnsaved('hafalan')">
              <span style="font-size:12px;color:var(--cream-dim)">surat</span>
              <button class="btn btn-gold btn-sm" onclick="saveProgress('hafalan')">ğŸ’¾</button>
            </div>
            <div class="target-meta">
              <span id="tp-hafalan-meta">Target: â€”</span>
              <span id="tp-hafalan-status">Belum diset</span>
            </div>
          </div>
        </div>

        <!-- Habit tracker -->
        <div class="card">
          <div class="card-title">ğŸš« Kebiasaan yang Ditinggalkan</div>
          <div class="field">
            <label style="font-size:11px;color:var(--cream-dim)">Kebiasaan apa yang ingin kamu tinggalkan?</label>
            <input type="text" id="t-habit-quit" placeholder="contoh: main hp sebelum tidur..." oninput="markHabitUnsaved()">
          </div>
          <div class="save-row" style="margin-bottom:14px">
            <span class="save-status" id="habit-save-status">âœï¸ Belum disimpan</span>
            <button class="btn btn-gold" onclick="saveHabitQuit()">ğŸ’¾ Simpan</button>
          </div>

          <!-- Streak counter -->
          <div id="habit-streak-section" style="display:none">
            <div style="background:rgba(212,175,55,.08);border:1px solid rgba(212,175,55,.2);border-radius:12px;padding:14px;text-align:center;margin-bottom:14px">
              <div style="font-size:11px;color:var(--cream-dim);letter-spacing:1px;text-transform:uppercase;font-family:'Cinzel',serif;margin-bottom:4px">Streak Hari Ini</div>
              <div style="font-size:36px;font-family:'Cinzel',serif;color:var(--gold);font-weight:700" id="habit-streak-num">0</div>
              <div style="font-size:11px;color:var(--cream-dim)" id="habit-streak-label">hari berhasil ditinggalkan</div>
            </div>

            <!-- Check in today button -->
            <button class="btn btn-gold btn-full" id="habit-checkin-btn" onclick="habitCheckIn()" style="margin-bottom:14px">
              âœ… Tandai Hari Ini Berhasil
            </button>

            <!-- History log -->
            <div style="font-size:12px;color:var(--gold);font-family:'Cinzel',serif;letter-spacing:1px;margin-bottom:8px">ğŸ“‹ RIWAYAT</div>
            <div id="habit-history-list">
              <div style="text-align:center;padding:12px;color:var(--cream-dim);font-style:italic;font-size:12px">Belum ada riwayat</div>
            </div>
          </div>
          <div id="habit-empty-hint" style="font-size:12px;color:var(--cream-dim);font-style:italic;text-align:center;padding:8px 0">
            Isi kebiasaan di atas lalu simpan untuk mulai tracking ğŸŒŸ
          </div>
        </div>
      </div>
    </div>

    <!-- PAGE 4: STATISTIK -->
    <div class="page" id="page-statistik">
      <div class="page-header">
        <div class="page-label">Pantau Perjalananmu</div>
        <div class="page-title">ğŸ“Š Statistik</div>
      </div>

      <div class="section-pad">
        <!-- Big stats -->
        <div class="stats-grid">
          <div class="stat-big">
            <div class="stat-big-num" id="st-days">0</div>
            <div class="stat-big-lbl">Hari Tercatat</div>
          </div>
          <div class="stat-big">
            <div class="stat-big-num" id="st-score">0</div>
            <div class="stat-big-lbl">Total Skor</div>
          </div>
          <div class="stat-big">
            <div class="stat-big-num" id="st-streak">0</div>
            <div class="stat-big-lbl">Streak Hari</div>
          </div>
          <div class="stat-big">
            <div class="stat-big-num" id="st-completion">0%</div>
            <div class="stat-big-lbl">Avg Selesai</div>
          </div>
        </div>

        <!-- Activity heatmap -->
        <div class="card">
          <div class="card-title">ğŸ—“ï¸ Activity 30 Hari</div>
          <div class="heatmap-grid" id="heatmap"></div>
          <div style="display:flex;gap:6px;align-items:center;margin-top:10px;justify-content:flex-end">
            <span style="font-size:10px;color:var(--cream-dim)">Sedikit</span>
            <div style="width:10px;height:10px;border-radius:2px;background:rgba(255,255,255,.05)"></div>
            <div style="width:10px;height:10px;border-radius:2px;" class="hm-cell level-1"></div>
            <div style="width:10px;height:10px;border-radius:2px;" class="hm-cell level-2"></div>
            <div style="width:10px;height:10px;border-radius:2px;" class="hm-cell level-3"></div>
            <div style="width:10px;height:10px;border-radius:2px;" class="hm-cell level-4"></div>
            <span style="font-size:10px;color:var(--cream-dim)">Penuh</span>
          </div>
        </div>

        <!-- Weekly bar chart -->
        <div class="card">
          <div class="card-title">ğŸ“ˆ Skor per Hari (30 Hari)</div>
          <div class="bar-chart" id="bar-chart"></div>
          <div style="display:flex;justify-content:space-between;margin-top:6px">
            <span style="font-size:9px;color:var(--cream-dim);font-family:'Cinzel',serif">Hari 1</span>
            <span style="font-size:9px;color:var(--cream-dim);font-family:'Cinzel',serif">Hari 30</span>
          </div>
        </div>

        <!-- Juz Tracker -->
        <div class="card">
          <div class="card-title">ğŸ“— Tracker Khatam 30 Juz</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div class="prog-bar" style="flex:1;margin-right:10px"><div class="prog-fill green" id="juz-bar" style="width:0%"></div></div>
            <span style="font-family:'Cinzel',serif;font-size:11px;color:var(--gold)" id="juz-label">0 / 30</span>
          </div>
          <div class="juz-grid" id="juz-grid"></div>
          <div style="font-size:11px;color:var(--cream-dim);text-align:center;margin-top:10px;font-style:italic">Tap juz untuk tandai sudah dibaca âœ“</div>
        </div>

        <!-- Progress summary -->
        <div class="card">
          <div class="card-title">ğŸ¯ Ringkasan Target</div>
          <div style="margin-bottom:10px">
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span style="color:var(--cream-dim)">ğŸ“– Khatam</span>
              <span style="color:var(--gold);font-family:'Cinzel',serif" id="sum-khatam">â€”</span>
            </div>
            <div class="prog-bar"><div class="prog-fill green" id="sum-khatam-bar" style="width:0%"></div></div>
          </div>
          <div style="margin-bottom:10px">
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span style="color:var(--cream-dim)">ğŸ’° Sedekah</span>
              <span style="color:var(--gold);font-family:'Cinzel',serif" id="sum-sedekah">â€”</span>
            </div>
            <div class="prog-bar"><div class="prog-fill" id="sum-sedekah-bar" style="width:0%"></div></div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span style="color:var(--cream-dim)">ğŸ“¿ Hafalan</span>
              <span style="color:var(--gold);font-family:'Cinzel',serif" id="sum-hafalan">â€”</span>
            </div>
            <div class="prog-bar"><div class="prog-fill teal" id="sum-hafalan-bar" style="width:0%"></div></div>
          </div>
        </div>

      </div>
    </div>

    <!-- PAGE 5: CATATAN & DOA -->
    <div class="page" id="page-catatan">
      <div class="page-header">
        <div class="page-label">Spesial Ramadhan</div>
        <div class="page-title">ğŸ¤² Catatan & Kirim</div>
      </div>

      <div class="section-pad">

        <!-- TAB SELECTOR -->
        <div class="cat-tabs">
          <button class="cat-tab active" onclick="switchCatTab('doa',this)">ğŸŒŸ Doa</button>
          <button class="cat-tab" onclick="switchCatTab('kirim-doa',this)">ğŸ’Œ Kirim Doa</button>
          <button class="cat-tab" onclick="switchCatTab('minta-maaf',this)">ğŸ™ Minta Maaf</button>
          <button class="cat-tab" onclick="switchCatTab('riwayat',this)">ğŸ“š Riwayat</button>
        </div>

        <!-- â”€â”€ TAB 1: DOA SPESIAL â”€â”€ -->
        <div class="cat-panel active" id="panel-doa">
          <div class="card doa-card">
            <div class="card-title" style="color:var(--teal)">ğŸŒŸ Doa Spesial Ramadhan</div>
            <div class="field">
              <label>Doa yang paling kamu inginkan tahun ini</label>
              <textarea id="doa-spesial" rows="4" placeholder="Ya Allah, aku berdoa..." class="notes-area"></textarea>
            </div>
            <div class="field">
              <label>3 Hal yang Disyukuri Hari Ini</label>
              <textarea id="doa-syukur" rows="3" placeholder="Alhamdulillah atas..." class="notes-area"></textarea>
            </div>
            <button class="btn btn-gold btn-full" onclick="saveDoa()">ğŸ’¾ Simpan Doa</button>
          </div>
        </div>

        <!-- â”€â”€ TAB 2: KIRIM DOA VIA WA â”€â”€ -->
        <div class="cat-panel" id="panel-kirim-doa">
          <div class="card">
            <div class="card-title">ğŸ’Œ Kirim Doa ke Orang Tercinta</div>
            <p style="font-size:13px;color:var(--cream-dim);margin-bottom:14px;font-style:italic">Bagikan doa terbaikmu di bulan Ramadhan ini langsung via WhatsApp.</p>

            <div class="field">
              <label>Nama Penerima</label>
              <input type="text" id="wa-nama" placeholder="contoh: Ibu, Ayah, Sahabat...">
            </div>

            <div class="field">
              <label>Hubungan</label>
              <div class="hub-grid" id="hub-grid-doa">
                <button class="hub-btn" onclick="selectHub(this,'doa','Ayah','ğŸ‘¨')">ğŸ‘¨ Ayah</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Ibu','ğŸ‘©')">ğŸ‘© Ibu</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Suami','ğŸ’‘')">ğŸ’‘ Suami</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Istri','ğŸ’‘')">ğŸ’‘ Istri</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Kakak','ğŸ«‚')">ğŸ«‚ Kakak</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Adik','ğŸ«‚')">ğŸ«‚ Adik</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Sahabat','ğŸ¤')">ğŸ¤ Sahabat</button>
                <button class="hub-btn" onclick="selectHub(this,'doa','Lainnya','ğŸ’›')">ğŸ’› Lainnya</button>
              </div>
            </div>

            <div class="field">
              <label>Template Doa</label>
              <div class="tpl-row">
                <div class="tpl-chip active" onclick="selectTpl(this,'doa','umum')">ğŸŒ™ Umum</div>
                <div class="tpl-chip" onclick="selectTpl(this,'doa','ortu')">â¤ï¸ Orang Tua</div>
                <div class="tpl-chip" onclick="selectTpl(this,'doa','pasangan')">ğŸ’‘ Pasangan</div>
                <div class="tpl-chip" onclick="selectTpl(this,'doa','sahabat')">ğŸ¤ Sahabat</div>
                <div class="tpl-chip" onclick="selectTpl(this,'doa','custom')">âœï¸ Custom</div>
              </div>
            </div>

            <div class="field">
              <label>Isi Pesan Doa</label>
              <textarea id="wa-pesan-doa" rows="5" class="notes-area" placeholder="Tulis doa untuk orang tersayang..."></textarea>
            </div>

            <div class="field">
              <label>Nomor WhatsApp</label>
              <div class="wa-inp-wrap">
                <span class="wa-prefix">+62</span>
                <input type="tel" id="wa-nomor-doa" placeholder="812-3456-7890">
              </div>
              <div style="font-size:11px;color:var(--cream-dim);margin-top:4px;font-style:italic">Tanpa angka 0 di depan</div>
            </div>

            <button class="btn btn-gold btn-full" onclick="kirimWA('doa')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
              Kirim via WhatsApp
            </button>
          </div>
        </div>

        <!-- â”€â”€ TAB 3: MINTA MAAF LEBARAN â”€â”€ -->
        <div class="cat-panel" id="panel-minta-maaf">
          <div class="card">
            <div class="card-title">ğŸ™ Ucapan Maaf Lebaran</div>
            <p style="font-size:13px;color:var(--cream-dim);margin-bottom:14px;font-style:italic">Kirim ucapan Idul Fitri & mohon maaf lahir batin via WhatsApp.</p>

            <div class="field">
              <label>Nama Penerima</label>
              <input type="text" id="maaf-nama" placeholder="contoh: Pak Budi, Bu Sari...">
            </div>

            <div class="field">
              <label>Hubungan</label>
              <div class="hub-grid" id="hub-grid-maaf">
                <button class="hub-btn" onclick="selectHub(this,'maaf','Ayah','ğŸ‘¨')">ğŸ‘¨ Ayah</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Ibu','ğŸ‘©')">ğŸ‘© Ibu</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Atasan','ğŸ‘”')">ğŸ‘” Atasan</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Rekan','ğŸ¤')">ğŸ¤ Rekan</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Kakak','ğŸ«‚')">ğŸ«‚ Kakak</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Adik','ğŸ«‚')">ğŸ«‚ Adik</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Sahabat','ğŸ’›')">ğŸ’› Sahabat</button>
                <button class="hub-btn" onclick="selectHub(this,'maaf','Lainnya','ğŸŒ™')">ğŸŒ™ Lainnya</button>
              </div>
            </div>

            <div class="field">
              <label>Template Ucapan</label>
              <div class="tpl-row">
                <div class="tpl-chip active" onclick="selectTpl(this,'maaf','formal')">ğŸ‘” Formal</div>
                <div class="tpl-chip" onclick="selectTpl(this,'maaf','keluarga')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Keluarga</div>
                <div class="tpl-chip" onclick="selectTpl(this,'maaf','santai')">ğŸ˜Š Santai</div>
                <div class="tpl-chip" onclick="selectTpl(this,'maaf','custom')">âœï¸ Custom</div>
              </div>
            </div>

            <div class="field">
              <label>Isi Ucapan</label>
              <textarea id="maaf-pesan" rows="5" class="notes-area" placeholder="Minal Aidin Wal Faizin..."></textarea>
            </div>

            <div class="field">
              <label>Nomor WhatsApp</label>
              <div class="wa-inp-wrap">
                <span class="wa-prefix">+62</span>
                <input type="tel" id="maaf-nomor" placeholder="812-3456-7890">
              </div>
            </div>

            <button class="btn btn-gold btn-full" onclick="kirimWA('maaf')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
              Kirim via WhatsApp
            </button>
          </div>
        </div>

        <!-- â”€â”€ TAB 4: RIWAYAT HARIAN â”€â”€ -->
        <div class="cat-panel" id="panel-riwayat">
          <div class="card">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
              <div class="card-title" style="margin-bottom:0">ğŸ“š Riwayat Harian</div>
              <button class="btn btn-danger btn-sm" onclick="confirmClearAll()">ğŸ—‘ï¸ Hapus Semua</button>
            </div>
            <div id="record-list">
              <div style="text-align:center;padding:24px;color:var(--cream-dim);font-style:italic;font-size:13px">
                Belum ada catatan tersimpan.<br>
                <span style="font-size:11px;opacity:.6">Isi checklist dan simpan dulu âœ¨</span>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div><!-- /pages -->

  <!-- â•â• BOTTOM NAV â•â• -->
  <nav class="bottom-nav">
    <button class="tab-btn active" onclick="goTab('home')" id="tab-home">
      <span class="tab-icon">ğŸ </span>
      <span class="tab-label">Beranda</span>
    </button>
    <button class="tab-btn" onclick="goTab('checklist')" id="tab-checklist">
      <span class="tab-icon">ğŸ“‹</span>
      <span class="tab-label">Checklist</span>
    </button>
    <button class="tab-btn" onclick="goTab('target')" id="tab-target">
      <span class="tab-icon">ğŸ¯</span>
      <span class="tab-label">Target</span>
    </button>
    <button class="tab-btn" onclick="goTab('statistik')" id="tab-statistik">
      <span class="tab-icon">ğŸ“Š</span>
      <span class="tab-label">Statistik</span>
    </button>
    <button class="tab-btn" onclick="goTab('catatan')" id="tab-catatan">
      <span class="tab-icon">ğŸ¤²</span>
      <span class="tab-label">Catatan</span>
    </button>
  </nav>

</div><!-- /app -->

<!-- Toast -->
<div id="toast"></div>

<!-- PWA Install Bar -->
<div id="pwa-bar">
  <div style="font-size:24px">ğŸŒ™</div>
  <div class="pwa-text">
    <div class="pwa-t">Install App</div>
    <div class="pwa-s">Akses offline & lebih cepat</div>
  </div>
  <button class="pwa-btn" id="pwa-install-btn">Install</button>
  <button class="pwa-x" id="pwa-close-btn">âœ•</button>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE & STORAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S = {
  get: (k, def=null) => {
    try { const v = localStorage.getItem(k); return v !== null ? JSON.parse(v) : def; } catch { return def; }
  },
  set: (k, v) => { try { localStorage.setItem(k, JSON.stringify(v)); } catch {} }
};

let ramadhanStart = S.get('rm_start', null);
let currentDay = 1;
let unsaved = false;

const SHOLAT_NAMES = ['Subuh','Dzuhur','Ashar','Maghrib','Isya'];
const CHECK_KEYS   = ['tarawih','quran','sahur','qiyam','dzikir','sedekah','istighfar','lisan','refleksi'];
const CHECK_PTS    = {tarawih:3, quran:5, sahur:2, qiyam:4, dzikir:2, sedekah:3, istighfar:2, lisan:2, refleksi:1};
const MAX_PTS      = Object.values(CHECK_PTS).reduce((a,b)=>a+b,0); // 24

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PAGES = ['home','checklist','target','statistik','catatan'];
let currentPage = 'home';

function goTab(name) {
  if (!PAGES.includes(name)) return;
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  document.getElementById('tab-' + name).classList.add('active');
  currentPage = name;

  if (name === 'statistik') renderStats();
  if (name === 'catatan')   renderRecords();
  if (name === 'checklist') renderChecklist();
  if (name === 'target')    renderHabitSection();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RAMADHAN DATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setRamadhanStart(val) {
  if (!val) return;
  S.set('rm_start', val);
  ramadhanStart = val;
  // Sync both date inputs
  document.getElementById('home-start-input').value  = val;
  document.getElementById('ring-start-input').value  = val;
  updateHomeProgress();
  updateDayFromDate();
  showToast('âœ… Tanggal Ramadhan disimpan!');
}

function getDayNum() {
  if (!ramadhanStart) return 0;
  const start = new Date(ramadhanStart);
  const now   = new Date();
  start.setHours(0,0,0,0); now.setHours(0,0,0,0);
  const diff = Math.floor((now - start) / 86400000) + 1;
  return Math.max(1, Math.min(30, diff));
}

function updateHomeProgress() {
  const day = getDayNum();
  const pct = Math.round((day / 30) * 100);
  const circ = 226.2;
  const off  = circ - (circ * pct / 100);

  document.getElementById('ring-prog').style.strokeDashoffset = off;
  document.getElementById('ring-pct').textContent  = pct + '%';
  document.getElementById('ring-sub').textContent  = `Hari ke-${day}`;
  document.getElementById('ring-day-num').innerHTML = `${day}<span>/30</span>`;
  document.getElementById('ring-hijri').textContent = ramadhanStart
    ? new Date(ramadhanStart).toLocaleDateString('id-ID', {day:'numeric',month:'long',year:'numeric'})
    : 'Set tanggal dulu';

  if (!ramadhanStart) {
    document.getElementById('start-banner').style.display = 'block';
  } else {
    document.getElementById('start-banner').style.display = 'none';
  }

  // Quick stats
  let totalSholat = 0, totalJuz = 0, totalSedekah = 0;
  for (let d = 1; d <= 30; d++) {
    const rec = S.get(`rm_day_${d}`);
    if (rec) {
      totalSholat += (rec.sholat || []).length;
      totalSedekah += rec.sedekah_done ? 1 : 0;
    }
  }
  totalJuz = Object.values(S.get('rm_juz', {})).filter(Boolean).length;
  document.getElementById('stat-sholat').textContent  = totalSholat;
  document.getElementById('stat-juz').textContent     = totalJuz;
  document.getElementById('stat-sedekah').textContent = totalSedekah;

  // Sync home sholat for today
  syncHomeSholat();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHECKLIST PAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateDayFromDate() {
  currentDay = getDayNum() || 1;
  renderChecklist();
}

function renderChecklist() {
  const d   = currentDay;
  const rec = S.get(`rm_day_${d}`, {});

  // Day display
  document.getElementById('cl-day-num').textContent  = d || 'â€”';
  document.getElementById('prev-day').disabled = d <= 1;
  document.getElementById('next-day').disabled = d >= 30;

  if (ramadhanStart) {
    const dt = new Date(ramadhanStart);
    dt.setDate(dt.getDate() + d - 1);
    document.getElementById('cl-day-date').textContent =
      dt.toLocaleDateString('id-ID', {weekday:'long', day:'numeric', month:'long'});
  } else {
    document.getElementById('cl-day-date').textContent = 'Set tanggal dulu';
  }

  // Mood
  document.querySelectorAll('#cl-mood .mood-btn').forEach(b => {
    b.classList.toggle('selected', b.textContent === (rec.mood || ''));
  });

  // Sholat
  const sholat = rec.sholat || [];
  document.querySelectorAll('#cl-sholat .sh-pill').forEach(p => {
    const name = p.querySelector('.sh-name').textContent;
    const done = sholat.includes(name);
    p.classList.toggle('done', done);
    p.querySelector('.sh-check').textContent = done ? 'âœ“' : 'â˜';
  });

  // Checks
  const checks = rec.checks || [];
  document.querySelectorAll('.check-item').forEach(item => {
    const key = item.dataset.key;
    const done = checks.includes(key);
    item.classList.toggle('checked', done);
  });

  // Sedekah
  document.getElementById('cl-sedekah').value = rec.sedekah_txt || '';

  // Notes
  document.getElementById('cl-notes').value = rec.notes || '';

  // Score
  updateScore();

  // Save status
  document.getElementById('save-status').textContent =
    rec._saved ? `âœ… Tersimpan ${rec._saved}` : 'âœï¸ Belum disimpan';
  unsaved = false;
}

function navigateDay(dir) {
  const next = currentDay + dir;
  if (next < 1 || next > 30) return;
  currentDay = next;
  renderChecklist();
}

function setMood(emoji) {
  document.querySelectorAll('#cl-mood .mood-btn').forEach(b =>
    b.classList.toggle('selected', b.textContent === emoji)
  );
  markUnsaved();
}

function toggleSholat(pill, name) {
  pill.classList.toggle('done');
  const done = pill.classList.contains('done');
  pill.querySelector('.sh-check').textContent = done ? 'âœ“' : 'â˜';
  markUnsaved();
}

function toggleHomeSholat(pill, name) {
  // Mirrors today's sholat in checklist
  const d = getDayNum() || 1;
  const rec = S.get(`rm_day_${d}`, {});
  let sholat = rec.sholat || [];
  if (sholat.includes(name)) {
    sholat = sholat.filter(s => s !== name);
  } else {
    sholat.push(name);
  }
  rec.sholat = sholat;
  S.set(`rm_day_${d}`, rec);
  syncHomeSholat();
  updateHomeProgress();
}

function syncHomeSholat() {
  const d = getDayNum() || 1;
  const rec = S.get(`rm_day_${d}`, {});
  const sholat = rec.sholat || [];
  document.querySelectorAll('#home-sholat .sh-pill').forEach(p => {
    const name = p.querySelector('.sh-name').textContent;
    const done = sholat.includes(name);
    p.classList.toggle('done', done);
    p.querySelector('.sh-check').textContent = done ? 'âœ“' : 'â˜';
  });
}

function toggleCheck(item, key) {
  item.classList.toggle('checked');
  markUnsaved();
  updateScore();
}

function updateScore() {
  const checked = [...document.querySelectorAll('.check-item.checked')]
    .map(el => el.dataset.key);
  const pts = checked.reduce((a, k) => a + (CHECK_PTS[k] || 0), 0);
  document.getElementById('cl-score').textContent = `${pts} / ${MAX_PTS} pts`;
  document.getElementById('cl-score-bar').style.width = `${(pts / MAX_PTS) * 100}%`;
}

function markUnsaved() {
  unsaved = true;
  document.getElementById('save-status').textContent = 'âœï¸ Ada perubahan belum disimpan';
}

function saveRecord() {
  const d = currentDay;
  const mood    = document.querySelector('#cl-mood .mood-btn.selected')?.textContent || '';
  const sholat  = [...document.querySelectorAll('#cl-sholat .sh-pill.done')]
                    .map(p => p.querySelector('.sh-name').textContent);
  const checks  = [...document.querySelectorAll('.check-item.checked')].map(i => i.dataset.key);
  const pts     = checks.reduce((a, k) => a + (CHECK_PTS[k] || 0), 0);
  const now     = new Date().toLocaleTimeString('id-ID', {hour:'2-digit',minute:'2-digit'});

  S.set(`rm_day_${d}`, {
    mood, sholat, checks,
    sedekah_done: checks.includes('sedekah'),
    sedekah_txt:  document.getElementById('cl-sedekah').value,
    notes:        document.getElementById('cl-notes').value,
    pts,
    _saved: now
  });

  unsaved = false;
  document.getElementById('save-status').textContent = `âœ… Tersimpan ${now}`;
  updateHomeProgress();
  showToast(`ğŸŒ™ Hari ${d} tersimpan! +${pts} pts`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TARGETS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadTargets() {
  const t = S.get('rm_targets', {});
  if (t.khatam)       document.getElementById('t-khatam').value       = t.khatam;
  if (t.sedekah)      document.getElementById('t-sedekah').value      = t.sedekah;
  if (t.hafalan)      document.getElementById('t-hafalan').value      = t.hafalan;
  if (t.habit_build)  document.getElementById('t-habit-build').value  = t.habit_build;
  if (t.habit_quit)   document.getElementById('t-habit-quit').value   = t.habit_quit;

  // Show saved status if data exists
  if (t.khatam || t.sedekah || t.hafalan || t.habit_build) {
    const el = document.getElementById('target-save-status');
    if (el) el.textContent = 'âœ… Tersimpan';
  }
  if (t.habit_quit) {
    const el = document.getElementById('habit-save-status');
    if (el) el.textContent = 'âœ… Tersimpan';
  }

  const p = S.get('rm_progress', {});
  if (p.khatam)  document.getElementById('tp-khatam-val').value  = p.khatam;
  if (p.sedekah) document.getElementById('tp-sedekah-val').value = p.sedekah;
  if (p.hafalan) document.getElementById('tp-hafalan-val').value = p.hafalan;

  ['khatam','sedekah','hafalan'].forEach(k => updateTargetProg(k));
  renderHabitSection();
}

function saveTargets() {
  const t = S.get('rm_targets', {});
  S.set('rm_targets', {
    ...t,
    khatam:      document.getElementById('t-khatam').value,
    sedekah:     document.getElementById('t-sedekah').value,
    hafalan:     document.getElementById('t-hafalan').value,
    habit_build: document.getElementById('t-habit-build').value,
    habit_quit:  document.getElementById('t-habit-quit').value,
  });
  ['khatam','sedekah','hafalan'].forEach(k => updateTargetProg(k));
}

function resetProgress(key) {
  if (!confirm(`Reset progress ${key}? Data progress akan dihapus.`)) return;
  const p = S.get('rm_progress', {});
  p[key] = 0;
  S.set('rm_progress', p);
  document.getElementById(`tp-${key}-val`).value = '';
  updateTargetProg(key);
  document.getElementById(`tp-${key}-status`).textContent = 'Belum ada progress';
  showToast(`ğŸ—‘ï¸ Progress ${key} direset`);
}

function resetAllProgress() {
  if (!confirm('Reset semua progress? (Khatam, Sedekah, Hafalan)')) return;
  S.set('rm_progress', {});
  ['khatam','sedekah','hafalan'].forEach(k => {
    document.getElementById(`tp-${k}-val`).value = '';
    updateTargetProg(k);
    document.getElementById(`tp-${k}-status`).textContent = 'Belum ada progress';
  });
  showToast('ğŸ—‘ï¸ Semua progress direset');
}

function resetTargets() {
  if (!confirm('Reset semua target? (Khatam, Sedekah, Hafalan, Kebiasaan Dibangun)')) return;
  const t = S.get('rm_targets', {});
  delete t.khatam; delete t.sedekah; delete t.hafalan; delete t.habit_build;
  S.set('rm_targets', t);
  ['t-khatam','t-sedekah','t-hafalan','t-habit-build'].forEach(id => {
    document.getElementById(id).value = '';
  });
  ['khatam','sedekah','hafalan'].forEach(k => updateTargetProg(k));
  const el = document.getElementById('target-save-status');
  if (el) el.textContent = 'âœï¸ Belum disimpan';
  showToast('ğŸ—‘ï¸ Target direset');
}

function deleteHabitEntry(idx) {
  if (!confirm('Hapus entry riwayat ini?')) return;
  const history = S.get('rm_habit_history', []);
  history.splice(idx, 1);
  S.set('rm_habit_history', history);
  renderHabitSection();
  showToast('ğŸ—‘ï¸ Entry dihapus');
}

function clearAllHabitHistory() {
  if (!confirm('Hapus SEMUA riwayat kebiasaan? Streak akan kembali ke 0.')) return;
  S.set('rm_habit_history', []);
  renderHabitSection();
  showToast('ğŸ—‘ï¸ Semua riwayat dihapus');
}

function markProgressUnsaved(key) {
  const statusEl = document.getElementById(`tp-${key}-status`);
  if (statusEl) statusEl.textContent = 'âœï¸ Belum disimpan';
}

function saveProgress(key) {
  updateTargetProg(key);
  const statusEl = document.getElementById(`tp-${key}-status`);
  const p = S.get('rm_progress', {});
  const t = S.get('rm_targets', {});
  const current = p[key] || 0;
  const target  = parseFloat(t[key]) || 0;
  const pct     = target > 0 ? Math.min(100, Math.round((current / target) * 100)) : 0;
  if (statusEl) {
    statusEl.textContent = pct >= 100 ? 'ğŸ‰ Tercapai!' : current > 0 ? `${current} / ${target}` : 'Belum ada progress';
  }
  const label = key === 'khatam' ? 'Khatam' : key === 'sedekah' ? 'Sedekah' : 'Hafalan';
  showToast(`âœ… Progress ${label} disimpan!`);
}

function markTargetUnsaved() {
  const el = document.getElementById('target-save-status');
  if (el) el.textContent = 'âœï¸ Belum disimpan';
}

function saveTargetsManual() {
  saveTargets();
  const el = document.getElementById('target-save-status');
  const now = new Date().toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'});
  if (el) el.textContent = `âœ… Tersimpan ${now}`;
  showToast('âœ… Target tersimpan!');
}

function markHabitUnsaved() {
  const el = document.getElementById('habit-save-status');
  if (el) el.textContent = 'âœï¸ Belum disimpan';
}

function saveHabitQuit() {
  const val = document.getElementById('t-habit-quit').value.trim();
  if (!val) { showToast('âš ï¸ Isi dulu kebiasaan yang ingin ditinggalkan'); return; }
  const t = S.get('rm_targets', {});
  t.habit_quit = val;
  S.set('rm_targets', t);
  const now = new Date().toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'});
  const el = document.getElementById('habit-save-status');
  if (el) el.textContent = `âœ… Tersimpan ${now}`;
  showToast('âœ… Kebiasaan disimpan!');
  renderHabitSection();
}

function habitCheckIn() {
  const today = new Date().toLocaleDateString('id-ID');
  const history = S.get('rm_habit_history', []);
  if (history.find(h => h.date === today)) {
    showToast('âœ… Sudah check-in hari ini!');
    return;
  }
  const t = S.get('rm_targets', {});
  history.unshift({ date: today, label: t.habit_quit || '' });
  S.set('rm_habit_history', history);
  showToast('ğŸ‰ Keren! Hari ini berhasil!');
  renderHabitSection();
}

function renderHabitSection() {
  const t = S.get('rm_targets', {});
  const habit = t.habit_quit || '';
  const streakSection = document.getElementById('habit-streak-section');
  const emptyHint     = document.getElementById('habit-empty-hint');

  if (!habit) {
    if (streakSection) streakSection.style.display = 'none';
    if (emptyHint)     emptyHint.style.display = 'block';
    return;
  }

  if (streakSection) streakSection.style.display = 'block';
  if (emptyHint)     emptyHint.style.display = 'none';

  // Hitung streak
  const history = S.get('rm_habit_history', []);
  let streak = 0;
  const now = new Date(); now.setHours(0,0,0,0);
  for (let i = 0; i < history.length; i++) {
    const d = new Date(history[i].date.split('/').reverse().join('-'));
    d.setHours(0,0,0,0);
    const diff = Math.round((now - d) / 86400000);
    if (diff === i) streak++;
    else break;
  }

  const numEl = document.getElementById('habit-streak-num');
  const lblEl = document.getElementById('habit-streak-label');
  if (numEl) numEl.textContent = streak;
  if (lblEl) lblEl.textContent = `hari "${habit}" berhasil ditinggalkan`;

  // Check-in button state
  const today = new Date().toLocaleDateString('id-ID');
  const checkedToday = history.find(h => h.date === today);
  const btn = document.getElementById('habit-checkin-btn');
  if (btn) {
    btn.textContent   = checkedToday ? 'âœ… Sudah Check-in Hari Ini' : 'âœ… Tandai Hari Ini Berhasil';
    btn.style.opacity = checkedToday ? '0.5' : '1';
  }

  // Render history list
  const listEl = document.getElementById('habit-history-list');
  if (!listEl) return;
  if (!history.length) {
    listEl.innerHTML = '<div style="text-align:center;padding:12px;color:var(--cream-dim);font-style:italic;font-size:12px">Belum ada riwayat</div>';
    return;
  }
  const rows = history.map((h, i) => `
    <div style="display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.05)">
      <div style="display:flex;align-items:center;gap:8px">
        <span style="font-size:16px">${i === 0 ? 'ğŸ†' : 'âœ…'}</span>
        <div>
          <div style="font-size:13px;color:var(--cream)">${h.date}</div>
          <div style="font-size:11px;color:var(--cream-dim);font-style:italic">${h.label || ''}</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:8px">
        <span style="font-family:'Cinzel',serif;font-size:10px;color:var(--gold)">Hari ${history.length - i}</span>
        <button class="btn btn-danger btn-sm" style="padding:4px 8px;font-size:9px" onclick="deleteHabitEntry(${i})">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
  const footer = '<div style="margin-top:10px;text-align:right"><button class="btn btn-danger btn-sm" onclick="clearAllHabitHistory()">ğŸ—‘ï¸ Hapus Semua Riwayat</button></div>';
  listEl.innerHTML = rows + footer;
}

function updateTargetProg(key) {
  const p = S.get('rm_progress', {});
  p[key] = parseFloat(document.getElementById(`tp-${key}-val`).value) || 0;
  S.set('rm_progress', p);

  const t       = S.get('rm_targets', {});
  const target  = parseFloat(t[key]) || 0;
  const current = p[key];
  const pct     = target > 0 ? Math.min(100, Math.round((current / target) * 100)) : 0;

  document.getElementById(`tp-${key}-bar`).style.width = pct + '%';
  document.getElementById(`tp-${key}-pct`).textContent  = pct + '%';
  document.getElementById(`tp-${key}-meta`).textContent =
    target > 0 ? `Target: ${key === 'sedekah' ? 'Rp' + target.toLocaleString('id-ID') : target}` : 'Target: belum diset';
  document.getElementById(`tp-${key}-status`).textContent =
    pct >= 100 ? 'ğŸ‰ Tercapai!' : pct > 0 ? `${current} / ${target}` : 'Belum ada progress';

  // Sync to statistik summary
  if (document.getElementById(`sum-${key}`)) {
    document.getElementById(`sum-${key}`).textContent =
      target > 0 ? `${current} / ${target}` : 'â€”';
    document.getElementById(`sum-${key}-bar`).style.width = pct + '%';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CATATAN PAGE â€” TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchCatTab(name, btn) {
  document.querySelectorAll('.cat-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.cat-panel').forEach(p => p.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('panel-' + name).classList.add('active');
  if (name === 'riwayat') renderRecords();
}

// Hub & template selectors per form
const hubState = { doa: {label:'',emoji:''}, maaf: {label:'',emoji:''}, thr: {label:'',emoji:''} };
const tplState = { doa: 'umum', maaf: 'formal', thr: 'anak' };

function selectHub(btn, form, label, emoji) {
  document.querySelectorAll(`#hub-grid-${form} .hub-btn`).forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  hubState[form] = { label, emoji };
  autoFillTemplate(form);
}

function selectTpl(chip, form, type) {
  chip.closest('.tpl-row').querySelectorAll('.tpl-chip').forEach(c => c.classList.remove('active'));
  chip.classList.add('active');
  tplState[form] = type;
  autoFillTemplate(form);
}

const NAMA_PLACEHOLDER = '[Nama]';

const TPL = {
  doa: {
    umum:    n => `ğŸŒ™ *Assalamu'alaikum ${n}*,\n\nDi bulan Ramadhan yang penuh berkah ini, aku titipkan doa tulus dari hatiku:\n\nğŸ¤² _Semoga Allah SWT senantiasa melimpahkan rahmat, keberkahan, dan perlindungan-Nya atasmu. Semoga ibadah Ramadhanmu diterima, dosa-dosamu diampuni, dan setiap doamu dikabulkan._\n\nRamadhan Mubarak, ${n}! ğŸŒŸ`,
    ortu:    n => `ğŸŒ™ *Assalamu'alaikum ${n}*,\n\n_Ridho Allah ada pada ridho orang tua._\n\nğŸ¤² Di Ramadhan yang mulia ini, aku berdoa:\n_Ya Allah, jagalah ${n}ku. Berikan beliau kesehatan, kebahagiaan, panjang umur yang berkah, dan ampunilah segala dosanya._\n\nTerima kasih sudah menjadi ${n} terbaik. Aku sangat menyayangimu. ğŸ’›\n\nRamadhan Mubarak! ğŸŒŸ`,
    pasangan:n => `ğŸŒ™ *Assalamu'alaikum ${n} Tersayangku*,\n\nğŸ¤² _Ya Allah, jagalah pasangan hidupku. Kuatkan cinta kami dalam keimanan, satukan kami dalam ketaatan, dan jadikan keluarga kami sakinah mawaddah warahmah._\n\nTerima kasih sudah menemani perjalanan ini. â¤ï¸\n\nRamadhan Mubarak, Sayang! ğŸŒŸ`,
    sahabat: n => `ğŸŒ™ *Assalamu'alaikum ${n}*,\n\nHei sahabat! ğŸ¤² _Semoga Allah permudah segala urusanmu, lapangkan rezekinya, dan jadikan kamu hamba yang selalu bersyukur._\n\nKamu sahabat terbaik! ğŸ¤ Ramadhan Mubarak! âœ¨`,
    custom:  n => `ğŸŒ™ *Assalamu'alaikum ${n}*,\n\n`,
  },
  maaf: {
    formal:  n => `ğŸŒ™ *Assalamu'alaikum Wr. Wb.*\n\nYth. ${n},\n\nDengan penuh kerendahan hati, di hari yang fitri ini saya mengucapkan:\n\nâœ¨ *Selamat Idul Fitri 1446 H*\n_Minal Aidin Wal Faizin_\n\nMohon maaf lahir dan batin atas segala kesalahan dan kekhilafan saya selama ini. ğŸ™\n\nSemoga Allah menerima amal ibadah kita dan menjadikan kita lebih baik ke depannya. Aamiin.\n\n_Wassalamu'alaikum Wr. Wb._`,
    keluarga:n => `ğŸŒ™ *Selamat Hari Raya Idul Fitri 1446 H* âœ¨\n\nBuat ${n} yang aku sayangi,\n\nğŸ¤² _Minal Aidin Wal Faizin_\nMohon maaf lahir dan batin ya ğŸ™\n\nSemoga Lebaran ini membawa kebahagiaan dan keberkahan buat kita semua. Aamiin! â¤ï¸\n\n_Taqabbalallahu minna wa minkum_ ğŸŒŸ`,
    santai:  n => `ğŸŠ *Selamat Lebaran ${n}!*\n\nMinal aidin wal faizin, mohon maaf lahir batin ya ğŸ™ğŸ˜„\n\nSemoga kita semua kembali fitri dan makin kompak setelah Ramadhan ini! ğŸ’ª\n\nHappy Eid! ğŸŒ™âœ¨`,
    custom:  n => `ğŸŒ™ Selamat Idul Fitri, ${n}!\n\n`,
  },
  thr: {
    anak:    (n, nom) => `ğŸŒ™ *Selamat Hari Raya Idul Fitri 1446 H* âœ¨\n\nBuat ${n} yang mana-mana,\n\nIni ada THR buat kamu ya â€” *Rp ${nom ? parseInt(nom).toLocaleString('id-ID') : '...'}* ğŸğŸ’µ\n\n_Minal Aidin Wal Faizin_\nSemoga selalu sehat, pintar, dan jadi anak yang sholeh/sholeha ya! ğŸ¤²\n\nSelamat Lebaran! ğŸŠ`,
    art:     (n, nom) => `ğŸŒ™ *Assalamu'alaikum ${n}*,\n\nSelamat Hari Raya Idul Fitri 1446 H âœ¨\n_Minal Aidin Wal Faizin_\n\nTerima kasih atas dedikasi dan kerja keras selama ini ğŸ™\nIni ada THR dari kami â€” *Rp ${nom ? parseInt(nom).toLocaleString('id-ID') : '...'}* ğŸ’µ\n\nSemoga bermanfaat dan membawa keberkahan. Selamat menikmati Lebaran! ğŸŠ`,
    custom:  (n, nom) => `ğŸŒ™ Selamat Lebaran ${n}!\n\nIni THR-nya ya â€” Rp ${nom ? parseInt(nom).toLocaleString('id-ID') : '...'} ğŸ’µ\n\n`,
  },
};

function autoFillTemplate(form) {
  const type = tplState[form];
  if (type === 'custom') return;

  let nama, pesanEl, nominalEl;
  if (form === 'doa')  { nama = document.getElementById('wa-nama').value.trim() || NAMA_PLACEHOLDER; pesanEl = document.getElementById('wa-pesan-doa'); }
  if (form === 'maaf') { nama = document.getElementById('maaf-nama').value.trim() || NAMA_PLACEHOLDER; pesanEl = document.getElementById('maaf-pesan'); }
  if (form === 'thr')  { nama = document.getElementById('thr-nama').value.trim() || NAMA_PLACEHOLDER; pesanEl = document.getElementById('thr-pesan'); nominalEl = document.getElementById('thr-nominal'); }

  const nominal = nominalEl?.value || '';
  const fn = TPL[form]?.[type];
  if (fn && pesanEl) pesanEl.value = fn(nama, nominal);
}

// Auto-update template when name/nominal changes
['wa-nama','maaf-nama','thr-nama','thr-nominal'].forEach(id => {
  document.addEventListener('DOMContentLoaded', () => {
    const el = document.getElementById(id);
    if (el) el.addEventListener('input', () => {
      const form = id.startsWith('wa-') ? 'doa' : id.startsWith('maaf-') ? 'maaf' : 'thr';
      autoFillTemplate(form);
    });
  });
});

function kirimWA(form) {
  let nama, nomor, pesan;
  if (form === 'doa') {
    nama  = document.getElementById('wa-nama').value.trim();
    nomor = document.getElementById('wa-nomor-doa').value.trim().replace(/\D/g,'');
    pesan = document.getElementById('wa-pesan-doa').value.trim();
  } else if (form === 'maaf') {
    nama  = document.getElementById('maaf-nama').value.trim();
    nomor = document.getElementById('maaf-nomor').value.trim().replace(/\D/g,'');
    pesan = document.getElementById('maaf-pesan').value.trim();
  } else if (form === 'thr') {
    nama  = document.getElementById('thr-nama').value.trim();
    nomor = document.getElementById('thr-nomor').value.trim().replace(/\D/g,'');
    pesan = document.getElementById('thr-pesan').value.trim();
  }

  if (!nama)  { showToast('âš ï¸ Isi nama penerima dulu!'); return; }
  if (!nomor || nomor.length < 8) { showToast('âš ï¸ Nomor WA tidak valid!'); return; }
  if (!pesan) { showToast('âš ï¸ Isi pesan dulu!'); return; }

  if (nomor.startsWith('0')) nomor = '62' + nomor.slice(1);
  else if (!nomor.startsWith('62')) nomor = '62' + nomor;

  showToast(`ğŸ•Šï¸ Membuka WhatsApp untuk ${nama}...`);
  setTimeout(() => window.open(`https://wa.me/${nomor}?text=${encodeURIComponent(pesan)}`, '_blank'), 500);
}

// â”€â”€ DOA SPESIAL (auto-save)
function saveDoa() {
  S.set('rm_doa', {
    spesial: document.getElementById('doa-spesial').value,
    syukur:  document.getElementById('doa-syukur').value,
  });
  showToast('âœ… Doa tersimpan!');
}

function loadDoa() {
  const d = S.get('rm_doa', {});
  if (d.spesial) document.getElementById('doa-spesial').value = d.spesial;
  if (d.syukur)  document.getElementById('doa-syukur').value  = d.syukur;
  // Auto-fill default templates
  autoFillTemplate('doa');
  autoFillTemplate('maaf');
  autoFillTemplate('thr');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATISTIK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStats() {
  let totalDays = 0, totalScore = 0, streak = 0, completions = [];

  for (let d = 1; d <= 30; d++) {
    const rec = S.get(`rm_day_${d}`);
    if (rec && rec._saved) {
      totalDays++;
      totalScore += rec.pts || 0;
      completions.push(Math.round(((rec.pts || 0) / MAX_PTS) * 100));
    } else {
      completions.push(0);
    }
  }

  // Streak
  const today = getDayNum() || 1;
  for (let d = today; d >= 1; d--) {
    const rec = S.get(`rm_day_${d}`);
    if (rec && rec._saved) streak++;
    else break;
  }

  const avgComp = totalDays > 0
    ? Math.round(completions.filter(c=>c>0).reduce((a,b)=>a+b,0) / totalDays)
    : 0;

  document.getElementById('st-days').textContent       = totalDays;
  document.getElementById('st-score').textContent      = totalScore;
  document.getElementById('st-streak').textContent     = streak;
  document.getElementById('st-completion').textContent = avgComp + '%';

  // Heatmap
  const hm = document.getElementById('heatmap');
  hm.innerHTML = '';
  for (let d = 1; d <= 30; d++) {
    const rec = S.get(`rm_day_${d}`);
    const pts = rec?.pts || 0;
    const lvl = pts === 0 ? 0 : pts <= 6 ? 1 : pts <= 12 ? 2 : pts <= 18 ? 3 : 4;
    const cell = document.createElement('div');
    cell.className = `hm-cell${lvl > 0 ? ' level-'+lvl : ''}`;
    cell.title = `Hari ${d}: ${pts} pts`;
    hm.appendChild(cell);
  }

  // Bar chart
  const bc = document.getElementById('bar-chart');
  bc.innerHTML = '';
  for (let d = 1; d <= 30; d++) {
    const rec = S.get(`rm_day_${d}`);
    const pts = rec?.pts || 0;
    const pct = (pts / MAX_PTS) * 100;
    const wrap = document.createElement('div');
    wrap.className = 'bar-wrap';
    wrap.innerHTML = `
      <div class="bar">
        <div class="bar-inner" style="height:${pct}%"></div>
      </div>
    `;
    bc.appendChild(wrap);
  }

  // Juz grid
  const juzState = S.get('rm_juz', {});
  const juzGrid = document.getElementById('juz-grid');
  if (!juzGrid.children.length) {
    for (let i = 1; i <= 30; i++) {
      const cell = document.createElement('div');
      cell.className = 'juz-cell' + (juzState[i] ? ' done' : '');
      cell.dataset.juz = i;
      cell.innerHTML = `<span class="jn">Juz ${i}</span><span class="jc">${juzState[i] ? 'âœ“' : 'â˜'}</span>`;
      cell.onclick = () => toggleJuz(cell, i);
      juzGrid.appendChild(cell);
    }
  } else {
    document.querySelectorAll('.juz-cell').forEach(cell => {
      const i = parseInt(cell.dataset.juz);
      cell.classList.toggle('done', !!juzState[i]);
      cell.querySelector('.jc').textContent = juzState[i] ? 'âœ“' : 'â˜';
    });
  }
  updateJuzBar();

  // Target summary
  ['khatam','sedekah','hafalan'].forEach(k => updateTargetProg(k));
}

function toggleJuz(cell, i) {
  const state = S.get('rm_juz', {});
  state[i] = !state[i];
  S.set('rm_juz', state);
  cell.classList.toggle('done', state[i]);
  cell.querySelector('.jc').textContent = state[i] ? 'âœ“' : 'â˜';
  updateJuzBar();
  updateHomeProgress();
}

function updateJuzBar() {
  const done = Object.values(S.get('rm_juz', {})).filter(Boolean).length;
  document.getElementById('juz-bar').style.width = `${(done/30)*100}%`;
  document.getElementById('juz-label').textContent = `${done} / 30`;
  document.getElementById('stat-juz').textContent = done;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RECORDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderRecords() {
  const list = document.getElementById('record-list');
  let html = '';
  let found = false;

  for (let d = 30; d >= 1; d--) {
    const rec = S.get(`rm_day_${d}`);
    if (!rec || !rec._saved) continue;
    found = true;
    const checks = rec.checks || [];
    const sholat = rec.sholat || [];
    const preview = rec.notes ? rec.notes.substring(0, 60) + (rec.notes.length > 60 ? '...' : '') : '';

    html += `
      <div class="record-item" onclick="toggleRecord(${d})">
        <div class="record-header">
          <span class="record-day">Hari ${d}</span>
          <span style="display:flex;align-items:center;gap:8px">
            <span style="font-family:'Cinzel',serif;font-size:10px;color:var(--gold)">${rec.pts||0} pts</span>
            <span class="record-mood">${rec.mood || 'â€”'}</span>
          </span>
        </div>
        <div class="record-meta">${sholat.length} sholat Â· ${checks.length} amalan${preview ? ' Â· '+preview : ''}</div>
        <div class="record-detail" id="rd-${d}">
          <div class="rd-row">
            ${sholat.map(s=>`<span class="rd-chip">ğŸ•Œ ${s}</span>`).join('')}
          </div>
          <div class="rd-row">
            ${checks.map(k=>`<span class="rd-chip">${k}</span>`).join('')}
          </div>
          ${rec.sedekah_txt ? `<div class="rd-note">ğŸ’° ${rec.sedekah_txt}</div>` : ''}
          ${rec.notes ? `<div class="rd-note">"${rec.notes}"</div>` : ''}
          <div style="display:flex;justify-content:flex-end;margin-top:10px">
            <button class="btn btn-danger btn-sm" onclick="event.stopPropagation();deleteRecord(${d})">ğŸ—‘ï¸ Hapus</button>
          </div>
        </div>
      </div>`;
  }

  if (!found) {
    html = `<div style="text-align:center;padding:24px;color:var(--cream-dim);font-style:italic;font-size:13px">
      Belum ada catatan tersimpan.<br>
      <span style="font-size:11px;opacity:.6">Isi checklist dan simpan dulu âœ¨</span>
    </div>`;
  }

  list.innerHTML = html;
}

function toggleRecord(d) {
  document.getElementById('rd-'+d)?.classList.toggle('open');
}

function deleteRecord(d) {
  if (!confirm(`Hapus record Hari ${d}?`)) return;
  localStorage.removeItem(`rm_day_${d}`);
  renderRecords();
  updateHomeProgress();
  showToast('ğŸ—‘ï¸ Record dihapus');
}

function confirmClearAll() {
  if (!confirm('Hapus SEMUA record harian? Tidak bisa dibatalkan.')) return;
  for (let i = 1; i <= 30; i++) localStorage.removeItem(`rm_day_${i}`);
  renderRecords();
  updateHomeProgress();
  showToast('ğŸ—‘ï¸ Semua record dihapus');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(t._timer);
  t._timer = setTimeout(() => t.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PWA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('sw.js', {scope:'/'})
      .then(r => console.log('[SW] ok', r.scope))
      .catch(e => console.warn('[SW] err', e));
  });
}

document.addEventListener('DOMContentLoaded', () => {
  const bar  = document.getElementById('pwa-bar');
  const iBtn = document.getElementById('pwa-install-btn');
  const xBtn = document.getElementById('pwa-close-btn');
  if (!bar) return;

  let prompt = null;
  const isStandalone = matchMedia('(display-mode:standalone)').matches || navigator.standalone;
  const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
  if (isStandalone) return;

  const dismissed = parseInt(S.get('pwa_dis', 0));
  function maybeShow() {
    if (Date.now() - dismissed > 7*864e5) setTimeout(()=>bar.classList.add('show'), 3000);
  }

  window.addEventListener('beforeinstallprompt', e => {
    e.preventDefault(); prompt = e; maybeShow();
  });

  iBtn.onclick = async () => {
    if (prompt) {
      prompt.prompt();
      const {outcome} = await prompt.userChoice;
      prompt = null; bar.classList.remove('show');
      if (outcome === 'accepted') showToast('ğŸŒ™ App berhasil diinstall!');
    } else if (isIOS) {
      showToast('ğŸ“² Tap Share â†’ Add to Home Screen');
    }
  };

  xBtn.onclick = () => {
    bar.classList.remove('show');
    S.set('pwa_dis', Date.now());
  };

  if (isIOS) {
    bar.querySelector('.pwa-s').textContent = 'Tap Share â†’ Add to Home Screen ğŸ“²';
    maybeShow();
  }

  window.addEventListener('appinstalled', () => {
    bar.classList.remove('show'); prompt = null;
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function init() {
  // Load saved start date
  if (ramadhanStart) {
    document.getElementById('home-start-input').value = ramadhanStart;
    document.getElementById('ring-start-input').value = ramadhanStart;
  }

  updateHomeProgress();
  updateDayFromDate();
  loadTargets();
  loadDoa();

  // Expose date input if no start set
  if (!ramadhanStart) {
    document.getElementById('ring-date-set').style.display = 'block';
    document.getElementById('start-banner').style.display = 'block';
  }
})();
</script>

<!-- Service Worker -->

</body>
</html>
